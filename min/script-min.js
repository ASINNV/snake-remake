function randomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e}function drawLine(e,t,n,a,r){ctx.strokeStyle=r,ctx.beginPath(),ctx.moveTo(e,t),ctx.lineTo(n,a),ctx.stroke()}function drawElement(e,t,n,a,r,o,c){ctx.shadowColor=o,ctx.shadowBlur=c,ctx.fillStyle=r,ctx.strokeStyle="rgba(255,255,255,0.1)",ctx.fillRect(e,t,n,a),ctx.strokeRect(e,t,n,a)}function spawnRandomNugget(){nuggetX=randomInt(0,columns),nuggetY=randomInt(0,rows)}var columns=40,rows=20,cellWidth=20,framesPerSecond=15,canvas,ctx,anchor=document.getElementById("anchor"),start_screen=document.getElementById("start-screen"),counter,count=0,highscoreboard,highscore=0,snakeColor="orange",headX=randomInt(0,columns),headY=randomInt(0,rows),tail,snake=[{x:0,y:0}],direction="right",nuggetX,nuggetY,bounded=!1,relay=document.getElementById("relay"),mySwitch=document.getElementById("switch");window.onload=function(){function e(){headX=Math.floor(columns/2),headY=Math.floor(rows/2),snake=[{x:headX,y:headY}],direction="right",spawnRandomNugget(),counter.innerText="length: "+snake.length,highscoreboard.innerText="best: "+highscore,start_screen.innerText="PRESS SPACE TO START",start_screen.style.display="block",setTimeout(function(){start_screen.style.opacity="1"},50),clearInterval(window.interval),window.interval=null}function t(){drawElement(0,0,canvas.width,canvas.height,"black");for(var e=0;e<=columns;e++)drawLine(e*cellWidth,0,e*cellWidth,canvas.height,"rgba(255,255,255,0.1)"),drawLine(0,e*cellWidth,canvas.width,e*cellWidth,"rgba(255,255,255,0.1)");for(drawElement(nuggetX*cellWidth,nuggetY*cellWidth,cellWidth,cellWidth,"#fff","#fff",20),e=0;e<snake.length;e++)drawElement(snake[e].x*cellWidth,snake[e].y*cellWidth,cellWidth,cellWidth,snakeColor,snakeColor,0)}function n(){"right"===direction&&headX++,"down"===direction&&headY++,"up"===direction&&headY--,"left"===direction&&headX--,!0===bounded&&(headX>=columns||headX<0||headY===rows||headY<0)?e():headX>=columns?headX=0:headX<0?headX=columns-1:headY===rows?headY=0:headY<0&&(headY=rows-1),snake.push({x:headX,y:headY}),tail=snake.shift(),nuggetX===headX&&nuggetY===headY&&(spawnRandomNugget(),snake.unshift(tail),counter.innerText="length: "+snake.length,count++);for(var t=0;t<snake.length;t++)nuggetX===snake[t].x&&nuggetY===snake[t].y&&spawnRandomNugget(),snake[t].x===headX&&snake[t].y===headY&&t!==snake.length-1&&(count>highscore&&(highscore=count),e())}canvas=document.createElement("canvas"),canvas.width=columns*cellWidth,canvas.height=rows*cellWidth,canvas.id="canvas",anchor.appendChild(canvas),counter=document.createElement("p"),counter.style.width=columns*cellWidth+"px",counter.setAttribute("class","read-out"),counter.innerText="length: "+snake.length,anchor.appendChild(counter),highscoreboard=document.createElement("p"),highscoreboard.style.width=columns*cellWidth+"px",highscoreboard.setAttribute("class","highscoreboard"),highscoreboard.innerText="best: "+highscore,anchor.appendChild(highscoreboard),ctx=canvas.getContext("2d"),spawnRandomNugget(),n(),t(),document.body.addEventListener("keydown",function(e){switch(e.keyCode){case 37:"right"===direction&&1!==snake.length||(direction="left");break;case 38:"down"===direction&&1!==snake.length||(direction="up");break;case 39:"left"===direction&&1!==snake.length||(direction="right");break;case 40:"up"===direction&&1!==snake.length||(direction="down");break;case 32:window.interval?(clearInterval(window.interval),window.interval=null,start_screen.innerText="PAUSED | PRESS SPACE TO RESUME",start_screen.style.display="block",setTimeout(function(){start_screen.style.opacity="1"},50)):(window.interval=setInterval(function(){t(),n()},1e3/framesPerSecond),start_screen.style.opacity="0",setTimeout(function(){start_screen.style.display="none"},100));break;default:return"some other key was pressed"}}),mySwitch.addEventListener("click",function(){!1===bounded?(bounded=!0,setTimeout(function(){relay.innerText="ON"},150),relay.style.transform="translateX(60%) translateY(-50%)",mySwitch.style.transform="translateX(150%)",mySwitch.style.boxShadow="-1px 0px 0px 0 rgba(0,0,0,0.2)",mySwitch.style.borderRight="0",mySwitch.style.borderLeft="1px solid #444"):(bounded=!1,setTimeout(function(){relay.innerText="OFF"},150),relay.style.transform="translateX(155%) translateY(-50%)",mySwitch.style.transform="translateX(0%)",mySwitch.style.boxShadow="1px 0px 0px 0 rgba(0,0,0,0.2)",mySwitch.style.borderRight="1px solid #444",mySwitch.style.borderLeft="0")})};